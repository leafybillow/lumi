void Plot(){
  TFile *rootfile = TFile::Open("lumi_chained.root");


  TCanvas *c11 =new TCanvas("c11","c11",800,800);
  TCanvas *c43 =new TCanvas("c43","c43",800,600);
  TCanvas *c21 =new TCanvas("c21","c21",1200,600);
  c21->SetLogy();
  
  TH2D* h2d = new TH2D("h2d","h2d",100,-10,10,100,-10,10);
  TH2D* h2d_beam = new TH2D("h2d_beam","h2d_beam",60,-30,30,60,-30,30);
  
  TH1D* h_hit_e = new TH1D("h_hit_e","h_hit_e",10,10,20);
  TH1D* h_hit_pos = new TH1D("h_hit_pos","h_hit_pos",10,10,20);
  TH1D* h_hit_gamma = new TH1D("h_hit_gamma","h_hit_gama",10,10,20);
  h_hit_e->SetLineColor(1);
  h_hit_pos->SetLineColor(2);
  h_hit_gamma->SetLineColor(4);
  
  h_hit_e->SetLineWidth(2);
  h_hit_pos->SetLineWidth(2);
  h_hit_gamma->SetLineWidth(2);

  TH1D* h_ekin_e = new TH1D("h_ekin_e","h_ekin_e",900,0,9000);
  TH1D* h_ekin_pos = new TH1D("h_ekin_pos","h_ekin_pos",900,0,9000);
  TH1D* h_ekin_gamma = new TH1D("h_ekin_gamma","h_ekin_gamma",900,0,9000);
  TH1D* h_ekin_prim = new TH1D("h_ekin_prim","h_ekin_prim",900,0,9000);
  TH1D* h_ekin_sec = new TH1D("h_ekin_sec","h_ekin_sec",900,0,9000);
  h_ekin_e->SetLineColor(1);
  h_ekin_pos->SetLineColor(2);
  h_ekin_gamma->SetLineColor(4);
  
  h_ekin_prim->SetLineColor(2);
  h_ekin_sec->SetLineColor(4);

  TLegend *leg_hit = new TLegend(0.1,0.9,0.3,0.7);
  leg_hit->AddEntry(h_hit_e,"electron","l");
  leg_hit->AddEntry(h_hit_pos,"positron","l");
  leg_hit->AddEntry(h_hit_gamma,"gamma","l");

  TLegend *leg_ekin = new TLegend(0.1,0.9,0.3,0.7);
  leg_ekin->AddEntry(h_ekin_e,"electron","l");
  leg_ekin->AddEntry(h_ekin_pos,"positron","l");
  leg_ekin->AddEntry(h_ekin_gamma,"gamma","l");

  TLegend *leg_electron = new TLegend(0.1,0.9,0.3,0.7);
  leg_electron->AddEntry(h_ekin_e,"Total","l");
  leg_electron->AddEntry(h_ekin_prim,"Primary","l");
  leg_electron->AddEntry(h_ekin_sec,"Secondary","l");

  //SAM
  lumi->Draw("hit_y:hit_x>>h2d","detID>10 && particleID==1","goff");
  c11->cd();
  h2d->Draw("COLZ");
  c11->SaveAs("SAM_2D_electron.pdf");
  
  lumi->Draw("detID>>h_hit_e","detID>10 && particleID==1 && Ekin>2","goff");
  lumi->Draw("detID>>h_hit_pos","detID>10 && particleID==2 && Ekin>2","goff");
  lumi->Draw("detID>>h_hit_gamma","detID>10 && particleID==0 ","goff");
  c43->cd();
  h_hit_e->Draw();
  h_hit_pos->Draw("same");
  h_hit_gamma->Draw("same");
  leg_hit->Draw("same");
  c43->SaveAs("SAM_hit_spec.pdf");


  lumi->Draw("detID>>h_ekin_e","detID>10 && particleID==1 && Ekin>2","goff");
  lumi->Draw("detID>>h_ekin_pos","detID>10 && particleID==2 && Ekin>2","goff");
  lumi->Draw("detID>>h_ekin_gamma","detID>10 && particleID==0 ","goff");
  c21->cd();
  h_ekin_e->Draw();
  h_ekin_pos->Draw("same");
  h_ekin_gamma->Draw("same");
  leg_ekin->Draw("same");
  c21->SaveAs("SAM_ekin_spec.pdf");
  

  //SAM electrons
  lumi->Draw("Ekin>>h_ekin_e","detID>10&& particleID==1 && Ekin>2","goff");
  lumi->Draw("Ekin>>h_ekin_prim","detID>10 && particleID==1 && Ekin>2 && trackID==1","goff");
  lumi->Draw("Ekin>>h_ekin_sec","detID>10 && particleID==1 && Ekin>2 && trackID>1","goff");
  c21->cd();
  c21->SetLogy();
  h_ekin_e->Draw();
  h_ekin_prim->Draw("same");
  h_ekin_sec->Draw("same");
  leg_electron->Draw("same");
  c21->SaveAs("SAM_Ekin_electron.pdf");

  //beam det 1
  lumi->Draw("hit_y:hit_x>>h2d_beam","detID==1 && particleID==1","goff");
  c11->cd();
  c11->SetLogz();
  h2d_beam->Draw("COLZ");
  c11->SaveAs("bdet1_2D_electron.pdf");
  
  lumi->Draw("Ekin>>h_ekin_e","detID==1&& particleID==1 && Ekin>2","goff");
  lumi->Draw("Ekin>>h_ekin_prim","detID==1 && particleID==1 && Ekin>2 && trackID==1","goff");
  lumi->Draw("Ekin>>h_ekin_sec","detID==1 && particleID==1 && Ekin>2 && trackID>1","goff");
  c21->cd();
  c21->SetLogy();
  h_ekin_e->Draw();
  h_ekin_prim->Draw("same");
  h_ekin_sec->Draw("same");
  leg_electron->Draw("same");
  c21->SaveAs("bdet1_Ekin_electron.pdf");

  //beam det 3
  lumi->Draw("hit_y:hit_x>>h2d_beam","detID==3 && particleID==1","goff");
  c11->cd();
  c11->SetLogz();
  h2d_beam->Draw("COLZ");
  c11->SaveAs("bdet3_2D_electron.pdf");
  
  lumi->Draw("Ekin>>h_ekin_tot","detID==3&& particleID==1 && Ekin>2","goff");
  lumi->Draw("Ekin>>h_ekin_prim","detID==3 && particleID==1 && Ekin>2 && trackID==1","goff");
  lumi->Draw("Ekin>>h_ekin_sec","detID==3 && particleID==1 && Ekin>2 && trackID>1","goff");
  c21->cd();
  c21->SetLogy();
  h_ekin_e->Draw();
  h_ekin_prim->Draw("same");
  h_ekin_sec->Draw("same");
  leg_electron->Draw("same");
  c21->SaveAs("bdet3_Ekin_electron.pdf");


  //Photons
  ///
  ///
  //SAM-photon
  lumi->Draw("hit_y:hit_x>>h2d","detID>10 && particleID==0","goff");
  c11->cd();
  h2d->Draw("COLZ");
  c11->SaveAs("SAM_2D_gamma.pdf");
  
  lumi->Draw("detID>>h_hit","detID>10 && particleID==0","goff");
  c43->cd();
  h_hit->Draw();
  c43->SaveAs("SAM_hit_gamma.pdf");
  
  lumi->Draw("Ekin>>h_ekin_gamma","detID>10&& particleID==0","goff");
  c21->cd();
  c21->SetLogy();
  h_ekin_gamma->Draw();
  c21->SaveAs("SAM_Ekin_gamma.pdf");

  //beam det 1-photon
  lumi->Draw("hit_y:hit_x>>h2d_beam","detID==1 && particleID==0","goff");
  c11->cd();
  c11->SetLogz();
  h2d_beam->Draw("COLZ");
  c11->SaveAs("bdet1_2D_gamma.pdf");
  
  lumi->Draw("Ekin>>h_ekin_gamma","detID==1&& particleID==0","goff");
  c21->cd();
  c21->SetLogy();
  h_ekin_gamma->Draw();
  c21->SaveAs("bdet1_Ekin_gamma.pdf");

  //beam det 3-photon
  lumi->Draw("hit_y:hit_x>>h2d_beam","detID==3 && particleID==0","goff");
  c11->cd();
  c11->SetLogz();
  h2d_beam->Draw("COLZ");
  c11->SaveAs("bdet3_2D_gamma.pdf");
  
  lumi->Draw("Ekin>>h_ekin_tot","detID==3&& particleID==0","goff");
  c21->cd();
  c21->SetLogy();
  h_ekin_gamma->Draw();
  c21->SaveAs("bdet3_Ekin_gamma.pdf");


  //Positrons
  ///
  ///
  //SAM-positron
  lumi->Draw("hit_y:hit_x>>h2d","detID>10 && particleID==2 && Ekin>2","goff");
  c11->cd();
  h2d->Draw("COLZ");
  c11->SaveAs("SAM_2D_positron.pdf");
  
  lumi->Draw("detID>>h_hit","detID>10 && particleID==2 && Ekin>2","goff");
  c43->cd();
  h_hit->Draw();
  c43->SaveAs("SAM_hit_positron.pdf");
  
  lumi->Draw("Ekin>>h_ekin_pos","detID>10&& particleID==2 && Ekin>2","goff");
  c21->cd();
  c21->SetLogy();
  h_ekin_pos->Draw();
  c21->SaveAs("SAM_Ekin_positron.pdf");

  //beam det 1-positron
  lumi->Draw("hit_y:hit_x>>h2d_beam","detID==1 && particleID==2 && Ekin>2","goff");
  c11->cd();
  c11->SetLogz();
  h2d_beam->Draw("COLZ");
  c11->SaveAs("bdet1_2D_positron.pdf");
  
  lumi->Draw("Ekin>>h_ekin_tot","detID==1&& particleID==2 && Ekin>2","goff");
  c21->cd();
  c21->SetLogy();
  h_ekin_tot->Draw();
  c21->SaveAs("bdet1_Ekin_positron.pdf");

  //beam det 3-positron
  lumi->Draw("hit_y:hit_x>>h2d_beam","detID==3 && particleID==2 && Ekin>2","goff");
  c11->cd();
  c11->SetLogz();
  h2d_beam->Draw("COLZ");
  c11->SaveAs("bdet3_2D_positron.pdf");
  
  lumi->Draw("Ekin>>h_ekin_pos","detID==3&& particleID==2 && Ekin>2","goff");
  c21->cd();
  c21->SetLogy();
  h_ekin_pos->Draw();
  c21->SaveAs("bdet3_Ekin_positron.pdf");


}
